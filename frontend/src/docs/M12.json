{
    "name": "Advanced SQL",
    "language": "sql",
    "content": [
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**Which of the following statements is true about a left join in SQL?**\n\n<br/>\n\nA. A left join returns all rows from both tables where the join condition is true.\n\nB. A left join returns all rows from the left table and matching rows from the right table.\n\nC. A left join returns all rows from the right table and matching rows from the left table.\n\nD. A left join returns only matching rows from both tables that satisfy the join condition."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**What happens if there is no matching row in the right table in a left join?**\n\n<br/>\n\nA. The join fails and no rows are returned.\n\nB. The join includes a null value for the columns from the right table.\n\nC. The join only returns rows from the left table.\n\nD. The join skips the unmatched rows from the left table."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**What does a full outer join return in SQL?**\n\n<br/>\n\nA. All rows from both tables where the join condition is true.\n\nB. All rows from the left table and matching rows from the right table.\n\nC. All rows from the right table and matching rows from the left table.\n\nD. All rows from both tables, including unmatched rows."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**What is the purpose of a self join in SQL?**\n\n<br/>\n\nA. To join a table with itself to create a new table.\n\nB. To compare rows within a table based on a certain condition.\n\nC. To filter out rows in a table based on a certain condition.\n\nD. To improve the performance of a query by reducing the number of joins."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**What is the difference between a UNION and an INTERSECT operation in SQL?**\n\n<br/>\n\nA. A UNION operation combines the results of two or more SELECT statements, while an INTERSECT operation returns only the rows that are common to both SELECT statements.\n\nB. A UNION operation returns only the rows that are common to both SELECT statements, while an INTERSECT operation combines the results of two or more SELECT statements.\n\nC. A UNION operation returns all the rows from both SELECT statements, while an INTERSECT operation returns only the distinct rows that are common to both SELECT statements.\n\nD. A UNION operation returns only the distinct rows from both SELECT statements, while an INTERSECT operation returns all the rows that are common to both SELECT statements."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**Which of the following statements is true about the COALESCE function in SQL?**\n\n<br/>\n\nA. It can only be used with numeric data types.\n\nB. It always returns a null value if all expressions are null.\n\nC. It only works with two expressions at a time.\n\nD. It can be used with any data type."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**What does the ROUND(x, n) function do in SQL?**\n\n<br/>\n\nA. It rounds the number x down to the nearest integer.\n\nB. It rounds the number x up to the nearest integer.\n\nC. It rounds the number x to n number of decimal places.\n\nD. It returns the smallest integer greater than or equal to the number x."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**Which of the following statements is true about the LEFT and RIGHT functions in SQL?**\n\n<br/>\n\nA. Both functions can be used to replace a specified substring in a string.\n\nB. Both functions return the entire string if the specified length is greater than the length of the string.\n\nC. The LEFT function can only be used with numeric data types.\n\nD. The RIGHT function can only be used with character data types."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "What is the result of using arithmetic operators with NULL values in SQL?\n\n<br/>\n\nA. An error message is returned.\n\nB. The result is always NULL.\n\nC. The NULL value is treated as zero.\n\nD. The NULL value is treated as one."
        },
        {
            "choices": [
                "A",
                "B",
                "C",
                "D"
            ],
            "resultType": "MULTICHOICE_SINGLE",
            "question": "**Which of the following SQL statements correctly uses the LAG() function to return the previous row's value of the 'sales' column in the 'orders' table?**\n\n<br/>\n\nA. `SELECT LAG(sales) OVER (ORDER BY date) as prev_sales, sales FROM orders;`\n\nB. `SELECT LAG(sales, 1) OVER (ORDER BY date) as prev_sales, sales FROM orders;`\n\nC. `SELECT LAG(sales, 1, 0) OVER (ORDER BY date) as prev_sales, sales FROM orders;`\n\nD. `SELECT LAG(sales, -1) OVER (ORDER BY date) as prev_sales, sales FROM orders;`"
        },
        {
            "question": "**List all track names along with their album from The Rolling Stones.**\n\n Order by albumn titles and track names.\n\n<br/>\n\nBelow are the first 5 rows of the output.",
            "resultType": "SQL",
            "tableData": [
                {
                    "TrackName": "19th Nervous Breakdown",
                    "AlbumTitle": "Hot Rocks, 1964-1971 (Disc 1)"
                },
                {
                    "TrackName": "As Tears Go By",
                    "AlbumTitle": "Hot Rocks, 1964-1971 (Disc 1)"
                },
                {
                    "TrackName": "Get Off Of My Cloud",
                    "AlbumTitle": "Hot Rocks, 1964-1971 (Disc 1)"
                },
                {
                    "TrackName": "Heart Of Stone",
                    "AlbumTitle": "Hot Rocks, 1964-1971 (Disc 1)"
                },
                {
                    "TrackName": "Let's Spend The Night Together",
                    "AlbumTitle": "Hot Rocks, 1964-1971 (Disc 1)"
                }
            ]
        },
        {
            "question": "**Retrieve the total number of tracks in each playlist.**\n\n Order by number of tracks in descending order.\n\n<br/>\n\nBelow are the first 5 rows of the output.",
            "resultType": "SQL",
            "tableData": [
                {
                    "PlaylistName": "Music",
                    "TrackCount": 3290
                },
                {
                    "PlaylistName": "Music",
                    "TrackCount": 3290
                },
                {
                    "PlaylistName": "90’s Music",
                    "TrackCount": 1477
                },
                {
                    "PlaylistName": "TV Shows",
                    "TrackCount": 213
                },
                {
                    "PlaylistName": "TV Shows",
                    "TrackCount": 213
                }
            ]
        },
        {
            "question": "**Find the total revenue generated by each album.**\n\n Order by total revenue in descending order.\n\n<br/>\n\nBelow are the first 5 rows of the output.",
            "resultType": "SQL",
            "tableData": [
                {
                    "AlbumTitle": "Battlestar Galactica (Classic), Season 1",
                    "TotalRevenue": 35.82
                },
                {
                    "AlbumTitle": "The Office, Season 3",
                    "TotalRevenue": 31.84
                },
                {
                    "AlbumTitle": "Minha Historia",
                    "TotalRevenue": 26.73
                },
                {
                    "AlbumTitle": "Heroes, Season 1",
                    "TotalRevenue": 25.87
                },
                {
                    "AlbumTitle": "Lost, Season 2",
                    "TotalRevenue": 25.87
                }
            ]
        },
        {
            "question": "**Find the number of invoices generated each year.**\n\n Order the result by year.\n\n<br/>\n\nExpected output:",
            "resultType": "SQL",
            "tableData": [
                {
                    "InvoiceYear": 2009,
                    "InvoiceCount": 83
                },
                {
                    "InvoiceYear": 2010,
                    "InvoiceCount": 83
                },
                {
                    "InvoiceYear": 2011,
                    "InvoiceCount": 83
                },
                {
                    "InvoiceYear": 2012,
                    "InvoiceCount": 83
                },
                {
                    "InvoiceYear": 2013,
                    "InvoiceCount": 80
                }
            ]
        },
        {
            "question": "**Find customers that spend over $40 at Chinook store.**\n\n Display their full name and order by total spending in descending order.\n\n<br/>\n\nBelow are the first 5 rows of the output.",
            "resultType": "SQL",
            "tableData": [
                {
                    "CustomerName": "Helena Holý",
                    "TotalSpending": 49.62
                },
                {
                    "CustomerName": "Richard Cunningham",
                    "TotalSpending": 47.62
                },
                {
                    "CustomerName": "Luis Rojas",
                    "TotalSpending": 46.62
                },
                {
                    "CustomerName": "Ladislav Kovács",
                    "TotalSpending": 45.62
                },
                {
                    "CustomerName": "Hugh O'Reilly",
                    "TotalSpending": 45.62
                }
            ]
        },
        {
            "question": "**Find the managers and the number of employees they manage in the store.**\n\n Display their fullname and order alphabetically.\n\n<br/>\n\nExpected output:",
            "resultType": "SQL",
            "tableData": [
                {
                    "ManagerName": "Andrew Adams",
                    "ManagedEmployees": 2
                },
                {
                    "ManagerName": "Michael Mitchell",
                    "ManagedEmployees": 2
                },
                {
                    "ManagerName": "Nancy Edwards",
                    "ManagedEmployees": 3
                }
            ]
        },
        {
            "question": "**Shows the total sales for each month along with the previous month's total sales and the difference between the two.**\n\nBelow are the first 5 rows of the output.\n\nHint: Use the LAG() window function to compare month-over-month performance.",
            "resultType": "SQL",
            "tableData": [
                {
                    "Month": "2009-01",
                    "Sales": 35.64,
                    "PreviousSales": 0,
                    "Difference": 35.64
                },
                {
                    "Month": "2009-02",
                    "Sales": 37.62,
                    "PreviousSales": 35.64,
                    "Difference": 1.98
                },
                {
                    "Month": "2009-03",
                    "Sales": 37.62,
                    "PreviousSales": 37.62,
                    "Difference": 0
                },
                {
                    "Month": "2009-04",
                    "Sales": 37.62,
                    "PreviousSales": 37.62,
                    "Difference": 0
                },
                {
                    "Month": "2009-05",
                    "Sales": 37.62,
                    "PreviousSales": 37.62,
                    "Difference": 0
                }
            ]
        },
        {
            "question": "**Rank the albums by their total sales revenue.**\n\n Display the album's id, title and order by their ranking.\n\n<br/>\n\n_Expected output_:\n\n ![](https://i.imgur.com/FZcMa9T.png)",
            "resultType": "SQL",
            "tableData": [
                {
                    "AlbumId": 253,
                    "Title": "Battlestar Galactica (Classic), Season 1",
                    "Total Sales": 35.82,
                    "Rank": 1
                },
                {
                    "AlbumId": 251,
                    "Title": "The Office, Season 3",
                    "Total Sales": 31.84,
                    "Rank": 2
                },
                {
                    "AlbumId": 23,
                    "Title": "Minha Historia",
                    "Total Sales": 26.73,
                    "Rank": 3
                },
                {
                    "AlbumId": 228,
                    "Title": "Heroes, Season 1",
                    "Total Sales": 25.87,
                    "Rank": 4
                },
                {
                    "AlbumId": 231,
                    "Title": "Lost, Season 2",
                    "Total Sales": 25.87,
                    "Rank": 4
                }
            ]
        },
        {
            "question": "**Find the total amount that each customer spent each month.**\n\n Display their full name and order by customer name and month\n\n<br/>\n\n_Expected output_:\n\n ![](https://i.imgur.com/ivuvPEc.png)",
            "resultType": "SQL",
            "tableData": [
                {
                    "CustomerName": "Luís Gonçalves",
                    "Month": "03",
                    "MonthlyTotal": 3.98
                },
                {
                    "CustomerName": "Luís Gonçalves",
                    "Month": "05",
                    "MonthlyTotal": 0.99
                },
                {
                    "CustomerName": "Luís Gonçalves",
                    "Month": "06",
                    "MonthlyTotal": 3.96
                },
                {
                    "CustomerName": "Luís Gonçalves",
                    "Month": "08",
                    "MonthlyTotal": 8.91
                },
                {
                    "CustomerName": "Luís Gonçalves",
                    "Month": "09",
                    "MonthlyTotal": 5.94
                }
            ]
        },
        {
            "question": "**Find the total amount each customer spent each month. Include only customers who spent more than $45.**\n\nDisplay their full name and order the results by customer name and month\n\n<br/>\n\n_Expected output_: There must be total **35 rows** in the output\n\n ![](https://i.imgur.com/afqIXrv.png)",
            "resultType": "SQL",
            "tableData": [
                {
                    "CustomerName": "Helena Holý",
                    "Month": "02",
                    "MonthlyTotal": 1.98
                },
                {
                    "CustomerName": "Helena Holý",
                    "Month": "04",
                    "MonthlyTotal": 0.99
                },
                {
                    "CustomerName": "Helena Holý",
                    "Month": "05",
                    "MonthlyTotal": 3.96
                },
                {
                    "CustomerName": "Helena Holý",
                    "Month": "07",
                    "MonthlyTotal": 8.91
                },
                {
                    "CustomerName": "Helena Holý",
                    "Month": "08",
                    "MonthlyTotal": 5.94
                }
            ]
        }
    ]
}